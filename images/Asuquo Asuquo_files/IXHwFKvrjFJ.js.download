if (self.CavalryLogger) { CavalryLogger.start_js(["4hY7H"]); }

__d("ZenonCallWindowErrors",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(babelHelpers.wrapNativeSuper(Error));b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(babelHelpers.wrapNativeSuper(Error));c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(babelHelpers.wrapNativeSuper(Error));d=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(babelHelpers.wrapNativeSuper(Error));f=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(babelHelpers.wrapNativeSuper(Error));var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(babelHelpers.wrapNativeSuper(Error)),h=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(babelHelpers.wrapNativeSuper(Error));e.exports={CannotAcceptInviteError:f,ConferenceNameMutationFailedError:b,IncompleteControllerParamsError:c,InviteNotFoundError:g,OpeningAnotherCallError:a,UninitializedError:h,UnsupportedThreadTypeError:d}}),null);
__d("FBPaymentsDialogContainerMount",["FBPaymentsDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").jsx(b("FBPaymentsDialogContainer.react"),{}),a)}};e.exports=a}),null);
__d("ZenonMediaError",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({ICE_FAILURE:"ICE failed",ICE_DISCONNECTED:"Connection Dropped"});e.exports={ZenonMediaError:a}}),null);
__d("ZenonDismissReason",["ZenonMediaError"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;f=b("ZenonMediaError").ZenonMediaError;b=Object.freeze({IGNORE_CALL:0,HANGUP_CALL:1,IN_ANOTHER_CALL:2,ACCEPT_AFTER_HANGUP:3,NO_ANSWER_TIMEOUT:4,INCOMING_TIMEOUT:5,OTHER_INSTANCE_HANDLED:6,SIGNALING_MESSAGE_FAILED:7,CONNECTION_DROPPED:8,CLIENT_INTERRUPTED:9,WEBRTC_ERROR:10,CLIENT_ERROR:11,NO_PERMISSION:12,OTHER_NOT_CAPABLE:13,NO_UI_ERROR:14,UNSUPPORTED_VERSION:15,CALLER_NOT_VISIBLE:16,CARRIER_BLOCKED:17,OTHER_CARRIER_BLOCKED:18,CLIENT_ENCRYPTION_ERROR:19,MICROPHONE_PERMISSION_DENIED:20,CAMERA_PERMISSION_DENIED:21,SESSION_MIGRATED:22,RING_MUTED:23,JOIN_APPROVAL_DENIED:24,REJECTED_BY_CALLEE:25,CALL_ENDED_BY_PRODUCT:26,CALL_ENDED:27,ANSWERED_ON_ANOTHER_DEVICE:28,REJECTED_ON_ANOTHER_DEVICE:29,CALL_COLLISION:30,MAX_ALLOWED_PARTICIPANTS_REACHED:31});function a(a){return h[a]}function c(a){return i[a]}function d(a){return j[a]}var h=Object.freeze({HangupCall:b.HANGUP_CALL,IgnoreCall:b.IGNORE_CALL,InAnotherCall:b.IN_ANOTHER_CALL,CallEndAcceptAfterHangUp:b.ACCEPT_AFTER_HANGUP,NoAnswerTimeout:b.NO_ANSWER_TIMEOUT,IncomingTimeout:b.INCOMING_TIMEOUT,OtherInstanceHandled:b.OTHER_INSTANCE_HANDLED,SignalingMessageFailed:b.SIGNALING_MESSAGE_FAILED,ConnectionDropped:b.CONNECTION_DROPPED,ClientInterrupted:b.CLIENT_INTERRUPTED,WebRTCError:b.WEBRTC_ERROR,ClientError:b.CLIENT_ERROR,NoPermission:b.NO_PERMISSION,OtherNotCapable:b.OTHER_NOT_CAPABLE,NoUIShown:b.NO_UI_ERROR,VersionUnsupported:b.UNSUPPORTED_VERSION,CallerNotVisible:b.CALLER_NOT_VISIBLE,CarrierBlocked:b.CARRIER_BLOCKED,OtherCarrierBlocked:b.OTHER_CARRIER_BLOCKED,ClientEncryptionError:b.CLIENT_ENCRYPTION_ERROR,InactiveTimeout:b.CALL_ENDED,Unknown:b.CALL_ENDED}),i=Object.freeze((g={},g[b.HANGUP_CALL]="HangupCall",g[b.IGNORE_CALL]="IgnoreCall",g[b.IN_ANOTHER_CALL]="InAnotherCall",g[b.ACCEPT_AFTER_HANGUP]="CallEndAcceptAfterHangUp",g[b.NO_ANSWER_TIMEOUT]="NoAnswerTimeout",g[b.INCOMING_TIMEOUT]="IncomingTimout",g[b.OTHER_INSTANCE_HANDLED]="OtherInstanceHandled",g[b.SIGNALING_MESSAGE_FAILED]="SignalingMessageFailed",g[b.CONNECTION_DROPPED]="ConnectinDropped",g[b.CLIENT_INTERRUPTED]="ClientInterrupted",g[b.WEBRTC_ERROR]="WebRTCError",g[b.CLIENT_ERROR]="ClientError",g[b.NO_PERMISSION]="NoPermission",g[b.OTHER_NOT_CAPABLE]="OtherNotCapable",g[b.NO_UI_ERROR]="NoUIShown",g[b.UNSUPPORTED_VERSION]="VersionUnsupported",g[b.CALLER_NOT_VISIBLE]="CallerNotVisible",g[b.CARRIER_BLOCKED]="CarrierBlocked",g[b.OTHER_CARRIER_BLOCKED]="OtherCarrierBlocked",g[b.CLIENT_ENCRYPTION_ERROR]="ClientEncryptionError",g)),j=Object.freeze((g={},g[f.ICE_FAILURE]=b.WEBRTC_ERROR,g[f.ICE_DISCONNECTED]=b.CONNECTION_DROPPED,g));e.exports={endCallToDismissReason:a,dismissToEndCallReason:c,mediaErrorToDismissReason:d,ZenonDismissReason:b}}),null);
__d("ZenonParticipantState",[],(function(a,b,c,d,e,f){"use strict";b=Object.freeze({UNKNOWN:0,DISCONNECTED:1,NO_ANSWER:2,REJECTED:3,UNREACHABLE:4,CONNECTION_DROPPED:5,CONTACTING:6,RINGING:7,NEGOTIATING:8,CONNECTING:9,CONNECTED:10,PARTICIPANT_LIMIT_REACHED:11,IN_ANOTHER_CALL:12,RING_TYPE_UNSUPPORTED:13});function a(a){return a==null?"disconnected":g[a]}var g=Object.freeze((c={},c[b.UNKNOWN]="disconnected",c[b.DISCONNECTED]="disconnected",c[b.NO_ANSWER]="disconnected",c[b.REJECTED]="disconnected",c[b.UNREACHABLE]="disconnected",c[b.CONNECTION_DROPPED]="disconnected",c[b.CONTACTING]="contacting",c[b.RINGING]="ringing",c[b.NEGOTIATING]="connecting",c[b.CONNECTING]="connecting",c[b.CONNECTED]="connected",c[b.PARTICIPANT_LIMIT_REACHED]="disconnected",c[b.IN_ANOTHER_CALL]="disconnected",c[b.RING_TYPE_UNSUPPORTED]="disconnected",c));e.exports={ZenonParticipantState:b,toCallParticipantState:a}}),null);
__d("ZenonSignalingMessage",[],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.getHeader=function(){return this.$1};b.getEvents=function(){return this.$2};b.setSignalingID=function(a){this.$1.signalingID=a};return a}();e.exports=a}),null);
__d("CallEndReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({IGNORE_CALL:"IgnoreCall",HANGUP_CALL:"HangupCall",IN_ANOTHER_CALL:"InAnotherCall",ACCEPT_AFTER_HANGUP:"CallEndAcceptAfterHangUp",NO_ANSWER_TIMEOUT:"NoAnswerTimeout",INCOMING_TIMEOUT:"IncomingTimeout",OTHER_INSTANCE_HANDLED:"OtherInstanceHandled",SIGNALING_MESSAGE_FAILED:"SignalingMessageFailed",CONNECTION_DROPPED:"ConnectionDropped",CLIENT_INTERRUPTED:"ClientInterrupted",WEBRTC_ERROR:"WebRTCError",CLIENT_ERROR:"ClientError",NO_PERMISSION:"NoPermission",OTHER_NOT_CAPABLE:"OtherNotCapable",NO_UI_ERROR:"NoUIShown",UNSUPPORTED_VERSION:"VersionUnsupported",CALLER_NOT_VISIBLE:"CallerNotVisible",CARRIER_BLOCKED:"CarrierBlocked",OTHER_CARRIER_BLOCKED:"OtherCarrierBlocked",CLIENT_ENCRYPTION_ERROR:"ClientEncryptionError"})}),null);
__d("WebrtcMessageType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OFFER:"offer",ANSWER:"answer",ICE_CANDIDATE:"ice_candidate",OK:"ok",HANG_UP:"hang_up",OTHER_DISMISS:"other_dismiss",MESSAGE_ACK:"msg_ack",PRANSWER:"pranswer",PING:"ping",PING_ACK:"ping_ack",ICE_RESTART_OFFER:"icerestart_offer",ICE_RESTART_ANSWER:"icerestart_answer",OFFER_ACK:"offer_ack",ANSWER_ACK:"answer_ack",SET_VIDEO:"set_video",ACK:"ack",INVALID:"invalid",OFFER_NACK:"offer_nack",NACK:"nack",VIDEO_REQUEST:"video_request",SDP_UPDATE:"sdp_update",SWITCH_TO_MULTIWAY:"switch_to_multiway",ON_HOLD:"on_hold",NEGOTIATE:"negotiate",RING:"ring",PR_OFFER_ACK:"pr_offer_ack",NOTIFY_MEDIA_STATE:"notify_media_state",CLIENT_REPORTED_EVENT:"client_reported_event"})}),null);
__d("ZenonP2PMessageTypes",["WebrtcMessageType","CallEndReason"],(function(a,b,c,d,e,f){e.exports={ZenonP2PSignalingPayloadType:b("WebrtcMessageType"),ZenonP2PCallEndReason:b("CallEndReason")}}),null);
__d("ZenonP2PTranslatorUtils",["CurrentUser","ZenonDismissReason","ZenonP2PMessageTypes"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ZenonDismissReason").ZenonDismissReason,h=b("ZenonP2PMessageTypes").ZenonP2PCallEndReason;a={p2pMessageToSignalingMessageHeader:function(a,c){var d=c.call_id,e=c.from;c=c.source;var f=e+":"+b("CurrentUser").getID();return{messageID:a,roomInfo:{name:f},remoteSignalingID:String(d),signalingID:String(d),protocol:"p2p",userInfo:{userID:b("CurrentUser").getID()},remoteInfo:{userID:e,deviceInfo:{deviceID:c}}}},fromP2PCallEndReason:function(a){a=i[a];return(a=a)!=null?a:g.CALL_ENDED},toP2PCallEndReason:function(a){a=j[a];return(a=a)!=null?a:h.HANGUP_CALL}};var i=Object.freeze((c={},c[h.HANGUP_CALL]=g.HANGUP_CALL,c[h.IGNORE_CALL]=g.IGNORE_CALL,c[h.IN_ANOTHER_CALL]=g.IN_ANOTHER_CALL,c[h.ACCEPT_AFTER_HANGUP]=g.ACCEPT_AFTER_HANGUP,c[h.NO_ANSWER_TIMEOUT]=g.NO_ANSWER_TIMEOUT,c[h.INCOMING_TIMEOUT]=g.INCOMING_TIMEOUT,c[h.OTHER_INSTANCE_HANDLED]=g.OTHER_INSTANCE_HANDLED,c[h.SIGNALING_MESSAGE_FAILED]=g.SIGNALING_MESSAGE_FAILED,c[h.CONNECTION_DROPPED]=g.CONNECTION_DROPPED,c[h.CLIENT_INTERRUPTED]=g.CLIENT_INTERRUPTED,c[h.WEBRTC_ERROR]=g.WEBRTC_ERROR,c[h.CLIENT_ERROR]=g.CLIENT_ERROR,c[h.NO_PERMISSION]=g.NO_PERMISSION,c[h.OTHER_NOT_CAPABLE]=g.OTHER_NOT_CAPABLE,c[h.NO_UI_ERROR]=g.NO_UI_ERROR,c[h.UNSUPPORTED_VERSION]=g.UNSUPPORTED_VERSION,c[h.CALLER_NOT_VISIBLE]=g.CALLER_NOT_VISIBLE,c[h.CARRIER_BLOCKED]=g.CARRIER_BLOCKED,c[h.OTHER_CARRIER_BLOCKED]=g.OTHER_CARRIER_BLOCKED,c[h.CLIENT_ENCRYPTION_ERROR]=g.CLIENT_ENCRYPTION_ERROR,c)),j=Object.freeze((d={},d[g.HANGUP_CALL]=h.HANGUP_CALL,d[g.IGNORE_CALL]=h.IGNORE_CALL,d[g.IN_ANOTHER_CALL]=h.IN_ANOTHER_CALL,d[g.ACCEPT_AFTER_HANGUP]=h.ACCEPT_AFTER_HANGUP,d[g.NO_ANSWER_TIMEOUT]=h.NO_ANSWER_TIMEOUT,d[g.INCOMING_TIMEOUT]=h.INCOMING_TIMEOUT,d[g.OTHER_INSTANCE_HANDLED]=h.OTHER_INSTANCE_HANDLED,d[g.SIGNALING_MESSAGE_FAILED]=h.SIGNALING_MESSAGE_FAILED,d[g.CONNECTION_DROPPED]=h.CONNECTION_DROPPED,d[g.CLIENT_INTERRUPTED]=h.CLIENT_INTERRUPTED,d[g.WEBRTC_ERROR]=h.WEBRTC_ERROR,d[g.CLIENT_ERROR]=h.CLIENT_ERROR,d[g.NO_PERMISSION]=h.NO_PERMISSION,d[g.OTHER_NOT_CAPABLE]=h.OTHER_NOT_CAPABLE,d[g.NO_UI_ERROR]=h.NO_UI_ERROR,d[g.UNSUPPORTED_VERSION]=h.UNSUPPORTED_VERSION,d[g.CALLER_NOT_VISIBLE]=h.CALLER_NOT_VISIBLE,d[g.CARRIER_BLOCKED]=h.CARRIER_BLOCKED,d[g.OTHER_CARRIER_BLOCKED]=h.OTHER_CARRIER_BLOCKED,d[g.CLIENT_ENCRYPTION_ERROR]=h.CLIENT_ENCRYPTION_ERROR,d));e.exports=a}),null);
__d("ZenonP2PMessageTranslator",["errorCode","ZenonDismissReason","ZenonP2PMessageTypes","ZenonP2PTranslatorUtils","ZenonParticipantState","ZenonSignalingMessage"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ZenonDismissReason").ZenonDismissReason,i=b("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType,j=b("ZenonParticipantState").ZenonParticipantState,k=0,l=3;a={toP2PMessage:function(a){__p&&__p();var b=a.getHeader();a=a.getEvents();if(a.length===0)throw new Error("Unexpected Translation: called toP2PMessage with empty signaling events");switch(a[0].eventName){case"answerIntentRequest":return t(b);case"inviteResponse":if(a[0].status==="NOT_SUPPORTED")return r(b);else return q(b);case"terminateRequest":return s(b,a[0]);default:return null}},toSignalingMessage:function(a){switch(a.type){case i.OFFER:return m(a);case i.HANG_UP:return n(a);case i.OTHER_DISMISS:return o(a);case i.ICE_CANDIDATE:return p(a);default:return null}}};function m(a){__p&&__p();var c=b("ZenonP2PTranslatorUtils").p2pMessageToSignalingMessageHeader(String(a.msg_id),a),d=[],e=a.escalation_conference_name,f=a.videoon,g=a.from;e={eventName:"inviteRequest",roomInfo:{name:e,context:{peerID:g,groupThreadID:null,serverInfoData:null}},inviterID:g,otherParticipants:[],isRemoteOfferer:!0,requestingVideo:f};d.push(e);f={eventName:"remoteSdpRequest",sdp:{sdp:a.sdp,type:"offer",version:0},mediaStates:{tracks:[],version:0},negotiateType:!1};d.push(f);e={eventName:"capabilitiesRequest",capabilities:{addParticipantEnabled:a.offer_escalation_support}};d.push(e);f=new Map([[g,j.CONNECTED]]);a={eventName:"participantUpdateRequest",participantStates:f,versionId:k};d.push(a);return new(b("ZenonSignalingMessage"))(c,d)}function n(a){var c=b("ZenonP2PTranslatorUtils").p2pMessageToSignalingMessageHeader(String(a.msg_id),a),d=[],e=a.reason;a=a.from;e={eventName:"terminateRequest",reason:b("ZenonP2PTranslatorUtils").fromP2PCallEndReason(e),shouldInformPeer:!0};d.push(e);e=new Map([[a,j.DISCONNECTED]]);a={eventName:"participantUpdateRequest",participantStates:e,versionId:l};d.push(a);return new(b("ZenonSignalingMessage"))(c,d)}function o(a){a=b("ZenonP2PTranslatorUtils").p2pMessageToSignalingMessageHeader(String(a.msg_id),a);var c=[],d={eventName:"terminateRequest",reason:h.OTHER_INSTANCE_HANDLED,shouldInformPeer:!0};c.push(d);return new(b("ZenonSignalingMessage"))(a,c)}function p(a){var c=b("ZenonP2PTranslatorUtils").p2pMessageToSignalingMessageHeader(String(a.msg_id),a),d=[],e=a.sdp,f=a.sdp_line_idx;a=a.sdp_mid;e={candidateSdpString:e,sdpMLineIndex:f,sdpMid:a};f={eventName:"iceCandidateRequest",iceCandidates:[e]};d.push(f);return new(b("ZenonSignalingMessage"))(c,d)}function q(a){if(a.signalingID===null)throw new Error("Unexpected P2P Translation: expected signalingID to not be null");return{type:"offer_ack",ack_id:parseInt(a.messageID,10),call_id:parseInt(a.signalingID,10),msg_id:parseInt(a.messageID,10)}}function r(a){if(a.signalingID===null)throw new Error("Unexpected P2P Translation: expected signalingID to not be null");return{type:"offer_nack",ack_id:parseInt(a.messageID,10),call_id:parseInt(a.signalingID,10),msg_id:parseInt(a.messageID,10),error_code:1356043}}function s(a,c){if(a.signalingID===null)throw new Error("Unexpected P2P Translation: expected signalingID to not be null");var d=parseInt(a.messageID,10);a=parseInt(a.signalingID,10);c=b("ZenonP2PTranslatorUtils").toP2PCallEndReason(c.reason);return{reason:c,call_id:a,msg_id:d,type:"hang_up",version:0}}function t(a){if(a.signalingID===null)throw new Error("Unexpected P2P Translation: expected signalingID to not be null");var b=parseInt(a.signalingID,10);a=parseInt(a.messageID,10);return{call_id:b,msg_id:a,type:"other_dismiss"}}e.exports=a}),null);
__d("ZenonP2PMessageValidator",["ZenonP2PMessageTypes"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType;a={validateAndTransformP2PMessage:function(a){__p&&__p();a=h(a);if(a){var b=a.msg_type;switch(b){case g.OFFER:return j(a);case g.HANG_UP:return k(a);case g.ICE_CANDIDATE:return i(a);case g.OTHER_DISMISS:return l(a)}}return null}};function h(a){a=JSON.parse(a);var b=a.from,c=a.call_id,d=a.id,e=a.msg_type,f=a.payload,g=a.source;a=a.type;if(b&&c&&f){c={call_id:c,from:b,id:d,msg_type:e,payload:f,source:g,type:a};return c}else throw Error("P2P message does not have valid from, call_id, and payload fields")}function i(a){var b=a.payload,c=a.from;a=a.source;b=JSON.parse(b);var d=b.call_id,e=b.capability,f=b.label,h=b.msg_id,i=b.version,j=b.sdp,k=b.sdp_line_idx;b=b.sdp_mid;c={from:c,source:a,call_id:d,capability:e,label:f,msg_id:h,sdp:j,sdp_line_idx:k,sdp_mid:b,type:g.ICE_CANDIDATE,version:i};return c}function j(a){__p&&__p();var b,c,d,e,f=a.payload,h=a.from;a=a.source;f=JSON.parse(f);var i=f.call_id,j=f.calltype,k=f.capability;b=(b=f.escalation_conference_name)!=null?b:null;c=(c=f.experiments)!=null?c:[];d=(d=f.extraParams)!=null?d:[];e=(e=f.fbexp)!=null?e:"";var l=f.handlescollision!==void 0?f.handlescollision:!1,m=f.offer_escalation_support!==void 0?f.offer_escalation_support:!1,n=f.msg_id,o=f.sdp;f=f.videoon;i={call_id:i,calltype:j,capability:k,escalation_conference_name:b,experiments:c,extraParams:d,fbexp:e,from:h,handlescollision:l,msg_id:n,sdp:o,source:a,offer_escalation_support:m,type:g.OFFER,videoon:f};return i}function k(a){var b=a.payload,c=a.from;a=a.source;b=JSON.parse(b);var d=b.call_id,e=b.capability,f=b.reason,h=b.msg_id;b=b.subreason;d={call_id:d,capability:e,from:c,msg_id:h,reason:f,subreason:b,source:a,type:g.HANG_UP};return d}function l(a){var b=a.payload,c=a.from;a=a.source;b=JSON.parse(b);var d=b.call_id,e=b.capability;b=b.msg_id;d={call_id:d,capability:e,from:c,msg_id:b,source:a,type:g.OTHER_DISMISS};return d}e.exports=a}),null);
__d("JewelQPLogging",["QPRenderer"],(function(a,b,c,d,e,f){var g=!1,h=null,i=!1;function j(){if(i)return;g&&h&&(i=!0,b("QPRenderer").logEvent(String(h.promotion_id),"view",h.instance_log_data?h.instance_log_data:{}))}a={onJewelOpened:function(){g=!0,j()},updateQPLogData:function(a){h=a,j()}};e.exports=a}),null);
__d("RequestsJewelStore",["Arbiter","ArbiterMixin","ChannelConstants"],(function(a,b,c,d,e,f){__p&&__p();a=babelHelpers["extends"]({},b("ArbiterMixin"),{_initialized:!1,_count:0,_requestList:{},addFriendRequests:function(a){Object.assign(this._requestList,a)},getRequestListKeys:function(){return Object.keys(this._requestList)},removeRequest:function(a){delete this._requestList[a]},getRequestCount:function(a){return this.getRequestListKeys().length},decrementCount:function(){this.setCount(Math.max(0,this._count-1))},setCount:function(a){b("Arbiter").inform("jewel/count-updated",{jewel:"requests",count:a},"state")},setupListeners:function(){__p&&__p();var a=this;if(this._initialized)return;this._initialized=!0;b("Arbiter").subscribe("jewel/count-updated",function(b,c){c.jewel==="requests"&&a._updateCount(c.count)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("jewel_requests_add"),function(b,c){return a._addRequest(c)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("jewel_friending_notifs"),function(b,c){return a._addNotification(c)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("mobile_requests_count"),function(b,c){return a._updateBadgeCountFromObject(c)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("jewel_requests_remove_old"),function(b,c){return a._removeOldRequest(c)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("friend_requests_seen"),function(b,c){return a.setCount(0)})},_updateCount:function(a){var b=this._count!==a;this._count=a;b&&this.inform("countUpdated",a)},_addRequest:function(a){__p&&__p();if(!a)return;a=a.obj;var b=a.from;a=a.suggester;b=this._requestList[b];b||this.setCount(this._count+1);b=b?b.type:null;a=b===19&&!a;this.inform("addRequest",{shouldReplace:a,previousType:b})},_updateBadgeCountFromObject:function(a){if(!a)return;a=a.obj;a=a.num_unseen+a.num_friend_confirmed_unseen;this._refreshJewel();this.setCount(a)},_addNotification:function(a){if(!a||a.obj.notif_type!=="friend_confirmed")return;this.inform("addNotification")},_removeOldRequest:function(a){if(!a)return;a=this._requestList[a.obj.from];if(!a)return;this.inform("removeOldRequest",a)},_refreshJewel:function(a){a===void 0&&(a=!1),this.inform("refreshJewel",a)}});e.exports=a}),null);
__d("XGigaboxxUpdateSeenTimeAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/gigaboxx/endpoint/writesafe/update_last_seen_time/",{})}),null);
__d("RequestsJewelController",["invariant","Promise","Arbiter","AsyncRequest","CSS","DOM","DOMQuery","Event","EventProfiler","Focus","FriendRequestIHEventLogger","JewelQPLogging","MarauderLogger","Parent","RequestsJewelStore","ScrollableArea","TimeSlice","WebFriendingRequests","XGigaboxxUpdateSeenTimeAsyncController","ge","getElementPosition","getViewportDimensions","promiseDone","requireWeak","throttle"],(function(a,b,c,d,e,f,g){__p&&__p();var h=null;b("requireWeak")("FriendBrowserCheckboxController",function(a){return h=a});var i=31,j=600,k=30,l=160;a=function(){"use strict";__p&&__p();a.getInstance=function(){return this.$11};a.updateFromDOM=function(){var a=this.getInstance();a&&a.fromDom()};a.setupScroll=function(){var a=this.getInstance();a&&a.setupScroll()};a.setInitialHeight=function(){var a=this.getInstance();a&&a.updateHeight()};a.maybeLoadJewel=function(){var a=this.getInstance();a&&a.maybeLoadJewel()};a.isOpen=function(){var a=this.getInstance();return a?a.$2():!1};a.create=function(b,c){this.$11&&g(0,5550);return this.$11=new a(b,c)};a.setupJewelRefresh=function(){b("Arbiter").subscribe(["FriendRequest/confirmFromProfile","FriendRequest/deleteFromProfile"],function(a,c){a={};a.reloadcontent=!0;new(b("AsyncRequest"))().setURI("/ajax/requests/loader/").setData(a).setAllowCrossPageTransition(!0).send()})};function a(a,c){__p&&__p();var d=this;this.$2=c;this.$1=a;this.$4=-1;this.$5=-1;this.$10=b("Promise").resolve(!0);this.$8=function(a){var c=this;b("throttle").acrossTransitionsWithBlocking(function(){return c.$12(a)},5e3)()};(c=b("RequestsJewelStore")).subscribe("addRequest",this.$13.bind(this));c.subscribe("addNotification",function(){return d.$14()});c.subscribe("removeOldRequest",this.$15.bind(this));c.subscribe("refreshJewel",this.$16.bind(this));c.setupListeners();this.setupScroll();this.$17();this.$18();this.$19()}var c=a.prototype;c.fromDom=function(){var a=this,c={};b("DOMQuery").scry(this.$1,"li.objectListItem").forEach(function(b){b=b.getAttribute("id");if(b){b=a.$20(b);b&&b.requester&&(c[b.requester]=b)}});b("RequestsJewelStore").addFriendRequests(c);this.$21()};c.maybeLoadJewel=function(){var a=this;this.$9&&(this.$9(function(){a.openHandler()}),this.$9=null)};c.updateHeight=function(){var a=this.$22();a&&(a.style.height=this.$23()+"px")};c.markSeen=function(){b("promiseDone")(this.$10,function(){new(b("AsyncRequest"))(b("XGigaboxxUpdateSeenTimeAsyncController").getURIBuilder().getURI()).setMethod("POST").send()})};c.openHandler=function(){__p&&__p();!this.$6&&this.$2()&&(this.$6=!0,b("EventProfiler").tagCurrentActiveInteractionsAs("FirstRequestsJewelOpen"));b("Arbiter").inform("requestsJewel/opened");var a=b("ge")("fbRequestsJewelLoading"),c=this.$22();if(!a&&!c)this.$9=b("TimeSlice").getGuardedContinuation("RequestsJewelController clickBeforeE2E continuation");else if(a)this.$8({log_impressions:!0});else{a=b("RequestsJewelStore").getRequestListKeys();a.length>0&&new(b("AsyncRequest"))().setAllowCrossPageTransition(!0).setURI("/friends/requests/log_impressions").setData({ids:a.join(","),ref:"jewel"}).send()}b("DOMQuery").scry(this.$1,"a.findFriendsLink").forEach(function(a){b("Focus").set(a)});c&&b("ScrollableArea").poke(c);b("JewelQPLogging").onJewelOpened()};c.closeHandler=function(){b("Arbiter").inform("requestsJewel/closed"),b("DOMQuery").scry(this.$1,"li.jewelItemNew").forEach(function(a){b("CSS").removeClass(a,"jewelItemNew")})};c.setupScroll=function(){var a=this.$22();a&&(this.$7=this.$24(),this.$3=0,b("ScrollableArea").getInstance(a).subscribe("scroll",this.$25.bind(this)),this.$26(),this.$27())};c.$17=function(){b("Event").listen(this.$1,"submit",function(a){a=b("Parent").byClass(a.getTarget(),"objectListItem");a&&(b("CSS").removeClass(a,"jewelItemNew"),b("CSS").addClass(a,"jewelItemResponded"))})};c.$18=function(){var a=this;b("Event").listen(window,"resize",b("throttle").acrossTransitions(function(){a.updateHeight()}))};c.$19=function(){var a=this;b("Arbiter").subscribe("pymk-x-out",function(b,c){b=c.location;(b==="pymk_jewel_first_page"||b==="pymk_jewel")&&a.$26()})};c.$28=function(a){a=parseInt(a,10);return isNaN(a)?null:a};c.$20=function(a){a=a.match(/^(\d+)_(\d+)/);return!a?null:{requester:this.$28(a[1]),type:this.$28(a[2])}};c.$29=function(a,b){return a==null||b==null?null:a+"_"+b};c.$30=function(a,b){return a==null||b==null?null:a+"_"+b+"_req"};a.$31=function(a){a=a.getAttribute("id");return a.substring(0,a.length-6)};c.$22=function(){return b("DOMQuery").scry(this.$1,".uiScrollableArea")[0]};c.$24=function(){return b("DOMQuery").scry(this.$1,".uiScrollableAreaWrap")[0]};c.$25=function(){__p&&__p();var a=b("DOMQuery").scry(this.$7,".uiMorePager").pop();if(a){var c=b("getElementPosition")(a).y,d=this.$22();c>0&&d&&b("CSS").addClass(d,"contentAfter");c=b("DOMQuery").find(a,"a");if(!c)return;d=b("getElementPosition")(c).y;if(d===this.$3)return;a=b("getElementPosition")(this.$7);a=a.y+a.height;if(d-300<a&&d>0){this.$3=d;a=c.getAttribute("ajaxify");a?new(b("AsyncRequest"))(a).setRelativeTo(c).setStatusElement(b("Parent").byClass(c,"stat_elem")).send():h&&h.getInstance("jewel").showMore()}}this.$26();this.$27()};c.$26=function(){__p&&__p();if(!this.$7)return;var a=b("getElementPosition")(this.$7);a=a.y+a.height;var c=b("DOMQuery").scry(this.$1,"li.friendBrowserListUnit"),d=c.length-1;while(d>this.$4){var e=b("getElementPosition")(c[d]),f=e.y;e=f+e.height;if(f>0&&e<=a)break;d-=1}f=d;while(d>this.$4)b("WebFriendingRequests").logPYMKImpression(c[d],"pymk_jewel"),d--;this.$4=Math.max(this.$4,f)};c.$27=function(){__p&&__p();if(!this.$7)return;var c=b("getElementPosition")(this.$7);c=c.y+c.height;var d=b("DOMQuery").scry(this.$1,"li.objectListItem"),e=d.length-1;while(e>this.$5){var f=b("getElementPosition")(d[e]),g=f.y;f=g+f.height;if(g>0&&f<=c)break;e-=1}g=e;while(e>this.$5){f=a.$31(d[e]);b("MarauderLogger").log("request_seen","friend_request_waterfall",{request_id:f,request_location:"requests_jewel"});b("FriendRequestIHEventLogger").logImpression(f);e-=1}this.$5=Math.max(this.$5,g)};c.$12=function(a){a===void 0&&(a={}),this.$10=new(b("Promise"))(function(c,d){var e=!b("ge")("fbRequestsJewelLoading");new(b("AsyncRequest"))().setURI("/ajax/requests/loader/").setData(babelHelpers["extends"]({},a,{reloadcontent:e})).setFinallyHandler(function(a){!a.getError()?c(!0):d()}).send()})};c.$14=function(){if(this.$2())return;this.$8()};c.$13=function(a,b){a=b.shouldReplace;b=b.previousType;if(!a&&(b||this.$2()))return;this.$8()};c.$15=function(a,c){a=c.requester;c=c.type;if(this.$2()||b("ge")("fbRequestsJewelLoading")!=null)return;var d=this.$29(a,c),e=d&&b("ge")(d);e||(d=this.$30(a,c),e=b("ge")(d));e&&(b("CSS").hasClass(e,"jewelItemNew")&&b("RequestsJewelStore").decrementCount(),b("CSS").hasClass(e,"jewelItemResponded")||(b("DOM").remove(e),b("RequestsJewelStore").removeRequest(a),this.$21()))};c.$16=function(a,b){if(b!==!0&&this.$2())return;this.$8()};c.$21=function(){b("DOMQuery").scry(this.$1,"li.empty").forEach(function(a){b("CSS").conditionShow(a,b("RequestsJewelStore").getRequestCount()<=0)})};c.$23=function(){return Math.min(Math.max(b("getViewportDimensions")().height-l,k),j)+i};return a}();a.$11=null;e.exports=a}),null);
__d("WaterfallMessageLifetimeTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:WaterfallMessageLifetimeLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:WaterfallMessageLifetimeLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:WaterfallMessageLifetimeLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAttemptID=function(a){this.$1.attempt_id=a;return this};c.setDestService=function(a){this.$1.dest_service=a;return this};c.setDeviceID=function(a){this.$1.device_id=a;return this};c.setEventType=function(a){this.$1.event_type=a;return this};c.setIsBatch=function(a){this.$1.is_batch=a;return this};c.setIsGroup=function(a){this.$1.is_group=a;return this};c.setMessageID=function(a){this.$1.message_id=a;return this};c.setOfflineThreadingID=function(a){this.$1.offline_threading_id=a;return this};c.setPageID=function(a){this.$1.page_id=a;return this};c.setPushNotifID=function(a){this.$1.push_notif_id=a;return this};c.setReceiptID=function(a){this.$1.receipt_id=a;return this};c.setSenderID=function(a){this.$1.sender_id=a;return this};c.setServiceName=function(a){this.$1.service_name=a;return this};c.setSrcService=function(a){this.$1.src_service=a;return this};c.setThreadID=function(a){this.$1.thread_id=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setTimeStamp=function(a){this.$1.time_stamp=a;return this};c.setTopic=function(a){this.$1.topic=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={attempt_id:!0,dest_service:!0,device_id:!0,event_type:!0,is_batch:!0,is_group:!0,message_id:!0,offline_threading_id:!0,page_id:!0,push_notif_id:!0,receipt_id:!0,sender_id:!0,service_name:!0,src_service:!0,thread_id:!0,time:!0,time_stamp:!0,topic:!0,weight:!0};e.exports=a}),null);
__d("FantaTabsEagerBootloader",["Bootloader","emptyFunction","ifRequired"],(function(a,b,c,d,e,f){"use strict";var g=function(a){b("ifRequired")("FantaAppStore",function(b){return b.addReducers(a)}),g=b("emptyFunction")};a={bootload:function(){b("ifRequired")("FantaTabsSlimApp",function(a){a.silentPumpUp()}),b("Bootloader").loadModules(["FantaReducersGetMessages","FantaTabsReactApp","MessengerGraphQLThreadFetcher.bs"],function(a){g(a)},"FantaTabsEagerBootloader")}};e.exports=a}),null);
__d("MercurySyncResnapshot",["Promise","Bootloader","MercurySingletonProvider"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(a){this.$2=a}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};var c=a.prototype;c.resnapshot=function(){var a=this;this.$1||(this.$1=new(b("Promise"))(function(c,d){b("Bootloader").loadModules(["MercurySyncDeltaHandler"],function(b){b.getForFBID(a.$2).emergencyDFF(function(b){c(b),a.$1=null},function(){d(),a.$1=null})},"MercurySyncResnapshot")}));return this.$1};return a}();var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MessageWaterfallLogger",["MqttEnv","WaterfallMessageLifetimeTypedLogger"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttEnv").MqttGkNames;a={logNewMessageToWaterfall:function(a){var c=a.senderID,d=a.receiptID,e=a.messageID,f=a.offlineThreadingID,i=a.threadID,j=a.irisSeqId;a=a.isGroup;if(!g.genGk(h.mqtt_waterfall_log_client_sampling))return;new(b("WaterfallMessageLifetimeTypedLogger"))().setEventType("message_receive_ws").setSrcService("mqtt").setDestService("webclient").setSenderID(c).setReceiptID(d).setMessageID(e).setOfflineThreadingID(f).setThreadID(i).setIsGroup(a?1:0).addToExtraData("sync_seq_id",j).log()}};e.exports=a}),null);
__d("MessengerMQTTPayloadPreprocessor",[],(function(a,b,c,d,e,f){"use strict";a={process:function(a,b,c){var d=parseInt(c.irisSeqId.toString(),10);return{seqID:d,obj:{queue:a,iseq:d,delta:c,seqID:d,type:b}}}};e.exports=a}),null);
__d("MessengerMQTTPresenceActivity",["CurrentUser","Event","MessengerMQTTPresenceReporting","Run","UserActivity"],(function(a,b,c,d,e,f){a={init:function(){b("Event").listen(window,"focus",function(){b("MessengerMQTTPresenceReporting").onUserActivity()}),b("Event").listen(window,"blur",function(){b("MessengerMQTTPresenceReporting").reportForegroundState(!1,!1)}),b("Run").onBeforeUnload(function(){b("MessengerMQTTPresenceReporting").reportForegroundState(!1,!0)},!1),b("UserActivity").subscribe(function(){b("MessengerMQTTPresenceReporting").onUserActivity()}),b("CurrentUser").isWorkUser()&&d(["WorkplaceChatHelper"],function(a){a.isDesktopChatApp()&&b("MessengerMQTTPresenceReporting").reportWorkchatDesktopCapability()})}};e.exports=a}),null);
__d("MessengerMQTTTypingDataPreProcessor",[],(function(a,b,c,d,e,f){"use strict";a={process:function(a,b){var c=b.thread;a=c==null?{from:b.sender_fbid,st:b.state,to:a,type:"typ"}:{from:b.sender_fbid,st:b.state,thread:c,thread_fbid:c,type:"ttyp"};return{obj:a}}};e.exports=a}),null);
__d("SyncProtocolClient",["Int64","MercurySingletonProvider","MqttEnv","SyncProtocolConstants","exponentialBackoff"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MqttEnv").Env;a=function(){__p&&__p();a.getForFBID=function(a){return h.getForFBID(a)};function a(a){var c=this;this.$1=a;this.$2=[];this.$5=g.getLoggerInstance();this.$10=new(b("exponentialBackoff"))(function(){return c.$11()},this)}var c=a.prototype;c.getPublishMessages=function(){return this.$12()};c.init=function(a,c,d,e){__p&&__p();var f=this;if(!c&&!e){this.$5.bumpCounter("sp_init_invalid_parameter");return this}this.$9=a;this.$8=!0;this.$3=c?b("Int64").fromString(c):null;this.$6=d;this.$7=e;this.$4=null;this.$9.subscribe("/t_ms",function(a){return f.$13(a)});this.$9.subscribe("/thread_typing",function(a){f.$14(a)});this.$9.subscribe("/orca_typing_notifications",function(a){f.$14(a)});this.$9.subscribe("/notify_disconnect",function(a){return f.$15(a)});this.connectToIris();return this};c.connectToIris=function(a){a===void 0&&(a=null),a!==null&&(this.$3=b("Int64").fromString(a)),this.$8=!0,this.$9.registerExtraConnectPayloadProvider(this)};c.$12=function(){__p&&__p();var a;if(this.$4){if(!this.$3){this.$5.bumpCounter("connect_payload_iris_no_seq_id");return[]}a=this.$16()}else a=this.$17();this.$5.debugTrace("Sending request with MQTT Connect",JSON.stringify({topic:a.topic,payload:a.payload}));return[a]};c.$11=function(){__p&&__p();var a;if(this.$4){if(!this.$3){this.$5.bumpCounter("subscribe_to_iris_no_seq_id");return}a=this.$16()}else a=this.$17();this.$5.debugTrace("Sending request",JSON.stringify({topic:a.topic,payload:a.payload}));this.$9.publish(a.topic,a.payload,{qos:1,skipBuffer:!0})};c.$18=function(a){var b=null;try{b=JSON.parse(a)}catch(a){this.$5.logError(a,"Unable to process data")}return b};c.$14=function(a){var b=this.$18(a);if(b==null){this.$5.logWarn("_processTypingData","Unable to process typing data");return}this.$2.forEach(function(a){typeof a.onTypingReceived==="function"&&a.onTypingReceived(b)})};c.addDeltaStreamListener=function(a){this.$2.push(a)};c.$15=function(a){this.$5.logWarn("_handleNotifyDisconnect","Disconnecting reason: "+a),this.$5.bumpCounter("notify_disconnect_"+a),a===b("SyncProtocolConstants").IRIS_CURSOR_LIMIT&&this.$19(a)};c.$19=function(a){this.$5.bumpCounter(a+"_request"),this.$4=null,this.$8=!1,this.$9.unregisterExtraConnectPayloadProvider(this),this.$2.forEach(function(b){return b.onStreamDisconnect(a)})};c.$13=function(a){a=this.$18(a);if(a==null){this.$5.logWarn("_processDeltas","Unable to process delta");return}var b={syncToken:a.syncToken,entityId:a.queueEntityId,errorCode:a.errorCode,firstSeqId:a.firstDeltaSeqId,lastSeqId:a.lastIssuedSeqId};this.$5.debugTrace("Sync data received",JSON.stringify(b));b=this.$1;a.queueEntityId!=null&&a.queueEntityId!=b?this.$5.bumpCounter("delta_for_other_fbid"):a.syncToken?this.$20(a):a.queueEntityId==null?this.$5.bumpCounter("no_fbid"):a.errorCode?this.$21(a.errorCode):this.$22(a)};c.$21=function(a){this.$5.bumpCounter("iris_queue_error."+a),this.$5.logWarn("_handleIrisError","Recevied an error code from sync protocol "+a),a==="ERROR_QUEUE_TEMPORARY_NOT_AVAILABLE"?this.$10():this.$19(a)};c.$20=function(a){var c=this,d=b("Int64").fromString(a.firstDeltaSeqId.toString());(this.$3===null||this.$3!=null&&!this.$3.equals(d))&&this.$5.bumpCounter("initial_sequence_id_mismatch");this.$4=a.syncToken;this.$3=d;this.$5.debugTrace("Sync token received",JSON.stringify({token:this.$4}));this.$9.subscribeChannelEvents({onMQTTStateChanged:function(a){a==="Connected"&&c.$10.reset()}})};c.$22=function(a){var c=a.deltas,d=this.$3;if(c&&d){var e=b("Int64").fromString(a.firstDeltaSeqId.toString());a=b("Int64").fromString(a.lastIssuedSeqId.toString());e.equals(d.add(b("Int64").ONE))?this.$23(e,a,c):e.compare(d)<0?(this.$5.bumpCounter("delta_batch_in_middle"),a.compare(d)>0&&this.$23(d.add(b("Int64").ONE),a,c)):(this.$5.bumpCounter("missing_deltas_get_diffs"),this.$11())}else this.$5.bumpCounter("process_deltas_invalid_state")};c.$23=function(a,c,d){__p&&__p();a=a;for(var e=0;e<d.length;e++){var f=d[e],g=f["class"]||"Missing",h={seqId:a.toString(),type:g,status:""},i=1;if(g!="Missing")try{i=this.$24(f,g,a,h)}catch(a){h.status="err:"+a.message}else h.status="no type",this.$5.bumpCounter("missing_delta_type");this.$5.debugTrace("onDeltaReceived",JSON.stringify(h));a=a.add(b("Int64").fromInt(i))}this.$3=c};c.$24=function(a,c,d,e){__p&&__p();var f=1,g="";c==="NoOp"&&(f=a.numNoOps||f,g+="n:"+f);a.irisSeqId||(a.irisSeqId=d.toString(),g+="missing seq id");var h=b("Int64").fromString(a.irisSeqId.toString())||d;h.equals(d)?g+=" seqId match":(g+=" seqId mismatch",this.$5.bumpCounter("seq_id_running_id_mismatch"));var i={type:c,payload:a};this.$2.forEach(function(a){return a.onDeltaReceived(i)});e.status=g;return f};c.$17=function(){var a={sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,initial_titan_sequence_id:this.$3&&this.$3.toString(),device_params:this.$6,queue_position:this.$7};return{topic:"/messenger_sync_create_queue",payload:JSON.stringify(a),qos:1}};c.$16=function(){var a={sync_token:this.$4,sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,last_seq_id:this.$3&&this.$3.toString()};return{topic:"/messenger_sync_get_diffs",payload:JSON.stringify(a),qos:1}};return a}();var h=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MessengerMQTTConnection",["requireCond","Arbiter","CurrentUser","FBMqttChannel","MercurySingletonProvider","MercurySyncResnapshot","MessageWaterfallLogger","MessengerMQTTConnectionEvents","MessengerMQTTPayloadPreprocessor","cr:1177633","MessengerMQTTTypingDataPreProcessor","MqttLogger","PresenceStatus","SyncProtocolClient","SyncProtocolConstants","gkx","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=(a=b("MessengerMQTTConnectionEvents")).DELTA_EVENT,h=a.STREAM_CONNECT,i=a.STREAM_DISCONNECT,j=a.STREAM_CONNECTING,k=a.STATE_CONNECTING,l=a.STATE_DISCONNECTED,m=a.TYP;c=function(){__p&&__p();a.getForFBID=function(a){return n.getForFBID(a)};a.get=function(){return n.get()};function a(a){this.$1=a,this.$2=b("MqttLogger").getInstance()}a.setUp=function(c){__p&&__p();var e=c.fbid,f=c.irisSeqID;c.appID;c.endpoint;if(!e||!f)return;var g=b("MqttLogger").getInstance();if(!b("CurrentUser").isLoggedInNow()){g.debugTrace("run","User not logged in");g.bumpCounter("user_not_loggged_in");return}var h=a.getForFBID(e);a.addDeltaStream({fbid:e,irisSeqID:f});h.$3(b("FBMqttChannel").getConnectionState(),b("FBMqttChannel").getLongPollingStatus());b("FBMqttChannel").subscribeChannelEvents({onMQTTStateChanged:function(a){h.$3(a,b("FBMqttChannel").getLongPollingStatus())},onJSError:function(a){g.bumpCounter("mqtt_js_error")}});b("cr:1177633")!=null&&b("cr:1177633").subscribe(b("PresenceStatus"));b("gkx")("845716")&&d(["MessengerMQTTPresenceActivity"],function(a){a.init()})};a.addDeltaStream=function(c){var d=c.fbid;c=c.irisSeqID;var e=a.getForFBID(d),f=null;b("gkx")("687751")&&(f={accept_pending_deltas:!0});b("SyncProtocolClient").getForFBID(d).init(b("FBMqttChannel"),c,f).addDeltaStreamListener(e)};var c=a.prototype;c.onDeltaReceived=function(a){var c=a.type;a=a.payload;try{c=="NewMessage"&&b("MessageWaterfallLogger").logNewMessageToWaterfall({senderID:a.messageMetadata.actorFbId,receiptID:this.$1,messageID:a.messageMetadata.messageId,offlineThreadingID:a.messageMetadata.offlineThreadingId,threadID:a.messageMetadata.threadKey.threadFbId!=null?a.messageMetadata.threadKey.threadFbId:"",irisSeqId:a.irisSeqId,isGroup:a.messageMetadata.threadKey.threadFbId!=null})}catch(a){this.$2.logError(a,"Unable to log to waterfall")}c=b("MessengerMQTTPayloadPreprocessor").process(this.$1,c,a);b("Arbiter").inform(g,c)};c.onStreamDisconnect=function(a){var c=this;if(a==="ERROR_QUEUE_LOST"||a==="ERROR_QUEUE_NOT_FOUND"||a==="ERROR_QUEUE_EXCEEDS_MAX_DELTAS"||a==="ERROR_QUEUE_UNDERFLOW"||a==="ERROR_QUEUE_OVERFLOW"){b("promiseDone")(b("MercurySyncResnapshot").getForFBID(this.$1).resnapshot(),function(a){b("SyncProtocolClient").getForFBID(c.$1).connectToIris(a.toString())},function(){b("Arbiter").inform(i,b("SyncProtocolConstants").SNAPSHOT_FAILURE)});return}a!==b("SyncProtocolConstants").IRIS_CURSOR_LIMIT&&this.$2.bumpCounter("unhandled_iris_error."+a);b("Arbiter").inform(i,a)};c.onTypingReceived=function(a){a=b("MessengerMQTTTypingDataPreProcessor").process(this.$1,a);b("Arbiter").inform(m,a)};c.$3=function(a,c){if(a=="Connected"||c=="LPActive"){b("Arbiter").inform(h);return}switch(a){case k:b("Arbiter").inform(j);break;case l:b("Arbiter").inform(i);break}};return a}();var n=new(b("MercurySingletonProvider"))(c);e.exports=c}),null);
__d("MessengerMQTTPresence",["BanzaiODS","FBMqttChannel","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="/orca_presence",h="mqtt_web.presence",i="/send_additional_contacts",j=!1;a={subscribe:function(a){if(j)return;j=!0;b("FBMqttChannel").subscribe(g,function(c){c=JSON.parse(c);c&&c.list&&(b("gkx")("983392")&&c.list_type&&c.list_type==="full"&&a.reset(),a.setMultiFromMQTT(c.list),b("BanzaiODS").bumpEntityKey(3303,h,"buddylist.event"),b("BanzaiODS").bumpEntityKey(3303,h,"buddylist.active_buddies",c.list.length))})},unsubscribe:function(){j=!1,b("FBMqttChannel").unsubscribeAll(g)},sendAdditionalBuddyRequest:function(a){b("FBMqttChannel").publish(i,JSON.stringify({additional_contacts:[a]}))}};e.exports=a}),null);
__d("MNCommerceDialogContainerMount",["MNCommerceDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").jsx(b("MNCommerceDialogContainer.react"),{}),a)}};e.exports=a}),null);
__d("P2PDialogContainerMount",["P2PDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").jsx(b("P2PDialogContainer.react"),{}),a)}};e.exports=a}),null);
__d("PagesPlatformDialogContainerMount",["PagesPlatformDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").jsx(b("PagesPlatformDialogContainer.react"),{}),a)}};e.exports=a}),null);