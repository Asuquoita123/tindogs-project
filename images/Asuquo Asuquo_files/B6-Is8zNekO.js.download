if (self.CavalryLogger) { CavalryLogger.start_js(["2Cwqy"]); }

__d("BloodDonorSettings",["DOM","DOMScroll","Run","URI","emptyFunction"],(function(a,b,c,d,e,f){__p&&__p();var g;a={scrollToSetting:function(a,c){var d=this;(g||(g=b("URI"))).getRequestURI().getQueryData().focus_blood_donor_settings&&b("Run").onLoad(function(){d._scrollAndFocus(a,c)})},_scrollAndFocus:function(a,c){c=c?b("emptyFunction"):function(){var c=b("DOM").scry(a,"blood_type")[0];c&&c.focus()};b("DOMScroll").scrollTo(a,500,!1,0,0,c)}};e.exports=a}),null);
__d("AggregatedMapCalloutOrientation",[],(function(a,b,c,d,e,f){a={};Object.assign(a,{TOP:"fbMapCalloutUseArrowTop",LEFT:"fbMapCalloutUseArrowLeft",RIGHT:"fbMapCalloutUseArrowRight",BOTTOM:"fbMapCalloutUseArrowBottom",ALWAYS_ON_MAP:"alwaysOnMap"});e.exports=a}),null);
__d("AggregatedMapCallout",["AggregatedMapCalloutOrientation","CSS","DOM","Style","Vector"],(function(a,b,c,d,e,f){__p&&__p();var g=16,h=10,i=10;function a(a,c,d){__p&&__p();this.map=a;this.contentContainer=null;this.width=null;this.height=null;this.anchor=null;this.orientation=b("AggregatedMapCalloutOrientation").RIGHT;this.arrowYOffset=null;this.arrowXOffset=null;this.border=c;this.contentContainer=(d=b("DOM")).find(this.border,".fbMapCalloutContent");this.arrowWrap=d.find(this.border,".fbMapCalloutArrowWrap");this.arrowL=d.find(this.border,".fbMapCalloutArrowLeft");this.arrowR=d.find(this.border,".fbMapCalloutArrowRight");this.arrowT=d.find(this.border,".fbMapCalloutArrowTop");this.arrowB=d.find(this.border,".fbMapCalloutArrowBottom");this._updateDimensions()}Object.assign(a.prototype,{setOrientation:function(a){this.orientation=a},getOrientation:function(){return this.orientation},getRoot:function(){return this.border},getAnchor:function(){return this.anchor},close:function(){this.anchor=null,this._map_updatePosition()},updateAnchor:function(a){this.anchor=a,this._map_updatePosition()},setContent:function(a){b("DOM").setContent(this.contentContainer,a),this._updateDimensions()},getContent:function(){return this.contentContainer},recalculateArrowYOffset:function(a){if(!this.anchor)return;a=this.map._callout_determineArrowYOffset(this,a,this.width,this.height);this.setArrowYOffset(a);this._map_updatePosition()},_updateDimensions:function(){b("CSS").show(this.border),this.width=b("Vector").getElementDimensions(this.border).x,this.height=b("Vector").getElementDimensions(this.border).y,this.setArrowXOffset(this.width/2),this.setArrowYOffset(this.height/2),b("CSS").hide(this.border)},_map_moveTo:function(a,b){this.anchor=a,this.map._callout_panTo(a,this,b),this._map_updatePosition()},_map_updatePosition:function(){__p&&__p();var a=this.anchor&&this.map._callout_getAnchorBounds(this.anchor);if(a===null){b("CSS").hide(this.border);return}var c,d,e,f,g=h,j=this.orientation;if(this.orientation===b("AggregatedMapCalloutOrientation").ALWAYS_ON_MAP){var k=a.getCenter().x,l=a.getCenter().y;k<0&&l<0?(d=i,c=i):k>this.map.ww&&l<0?(e=i,c=i):k>this.map.ww&&l>this.map.hh?(e=i,f=i):k<0&&l>this.map.hh?(d=i,f=i):k<0?(j=b("AggregatedMapCalloutOrientation").RIGHT,d=i,c=a.calloutY-this.arrowYOffset):k>this.map.ww?(j=b("AggregatedMapCalloutOrientation").LEFT,e=i,c=a.calloutY-this.arrowYOffset):l<0?(j=b("AggregatedMapCalloutOrientation").BOTTOM,c=i,d=(a.l+a.r)/2-this.arrowXOffset):l>this.map.hh?(j=b("AggregatedMapCalloutOrientation").TOP,f=i,d=(a.l+a.r)/2-this.arrowXOffset):(c=a.calloutY-this.arrowYOffset,k<this.map.ww/2?(d=a.r+g,j=b("AggregatedMapCalloutOrientation").RIGHT):(d=a.l-g-this.width,j=b("AggregatedMapCalloutOrientation").LEFT))}switch(this.orientation){case b("AggregatedMapCalloutOrientation").LEFT:d=a.l-g-this.width;c=a.calloutY-this.arrowYOffset;break;case b("AggregatedMapCalloutOrientation").RIGHT:d=a.r+g;c=a.calloutY-this.arrowYOffset;break;case b("AggregatedMapCalloutOrientation").TOP:f=this.map._getH()-a.t+g;d=(a.l+a.r)/2-this.arrowXOffset;break;case b("AggregatedMapCalloutOrientation").BOTTOM:c=a.b+g;d=(a.l+a.r)/2-this.arrowXOffset;break}b("CSS").setClass(this.arrowWrap,j);this._setPosition("top",c);this._setPosition("right",e);this._setPosition("bottom",f);this._setPosition("left",d);b("CSS").show(this.border)},_setPosition:function(a,c){c!==void 0?c+="px":c="auto",b("Style").set(this.border,a,c)},setArrowXOffset:function(a){this.arrowXOffset=a,a-=Math.round(g/2),b("Style").set(this.arrowT,"left",a+"px"),b("Style").set(this.arrowB,"left",a+"px")},setArrowYOffset:function(a){this.arrowYOffset=a,a-=Math.round(g/2),b("Style").set(this.arrowL,"top",a+"px"),b("Style").set(this.arrowR,"top",a+"px")}});Object.assign(a,{throbber:function(a){a=a||this.DEFAULT_CALLOUT_WIDTH;var c=b("DOM").create("div",{}),d=b("DOM").create("img",{src:"/images/loaders/indicator_blue_small.gif"});b("CSS").setClass(c,"fbAggregatedMapCalloutThrobberDiv");b("Style").set(c,"width",a+"px");b("CSS").setClass(d,"fbAggregatedMapCalloutThrobber");b("DOM").setContent(c,d);return c},ARROW_HEIGHT_PLUS_PADDING:h,ARROW_WIDTH:g});e.exports=a}),null);
__d("AggregatedMapMarker",["DOM","Style"],(function(a,b,c,d,e,f){__p&&__p();function a(a,b){this._root=a,this._sprite=b}Object.assign(a.prototype,{setPosition:function(a){var c=a.y-this._sprite.getAnchorY();a=a.x-this._sprite.getAnchorX();b("Style").set(this._root,"top",Math.round(c)+"px");b("Style").set(this._root,"left",Math.round(a)+"px")},setOnClick:function(a){this._root.onclick=a},setOnMouseover:function(a){this._root.onmouseover=a},setOnMouseout:function(a){this._root.onmouseout=a},remove:function(){b("DOM").remove(this._root)},getElement:function(){return this._root}});e.exports=a}),null);
__d("AggregatedMapZIndex",[],(function(a,b,c,d,e,f){a={};Object.assign(a,{DEFAULT_PIN_BASE_Z_INDEX:1e3,PIN_Z_INDEX_MAXIMUM_ADD:4e3,DEFAULT_PIN_MAX_Z_INDEX:5e3,CONTROLS_Z_INDEX:7e3,CALLOUT_Z_INDEX:9e3,TOOLTIP_Z_INDEX:9100});e.exports=a}),null);
__d("AggregatedMapGroup",["AggregatedMapMarker","AggregatedMapZIndex","DOM","LegacyMapCoordinate","Rect","Style","clamp"],(function(a,b,c,d,e,f){__p&&__p();function a(a,b,c,d){this._boundingBox=b,this._sprite=c,this._marker=null,this._mapToPixel=d,this.pins=a,this.deleted=!1}Object.assign(a.prototype,{getType:function(){return"AggregatedMapGroup"},getCenter:function(){return this._mapToPixel(this._boundingBox.getCenter())},getCenterLatLong:function(a){var c=this._boundingBox.getCenter();c=b("LegacyMapCoordinate").fromMap(c.x,c.y,a);return{latitude:c.getLatitude(),longitude:c.getLongitude()}},hasMarker:function(){return!!this._marker},dismissMarker:function(){this._marker&&(this._marker.remove(),this._marker=null)},getMarker:function(){return this._marker&&this._marker.getElement()},getSprite:function(){return this._sprite},updatePosition:function(a){if(!this._marker)return;a=this.getCenter();this._marker.setPosition(a)},getSpriteBounds:function(){var a=this._sprite,c=this.getCenter().y-a.getAnchorY(),d=this.getCenter().x-a.getAnchorX(),e=d+a.getWidth(),f=c+a.getHeight();e=new(b("Rect"))(c,e,f,d);e.calloutY=c+a.getCalloutY();return e},isSinglePin:function(){return this.pins.length==1},renderMarker:function(a){__p&&__p();if(!this._marker){var c=this._sprite,d=c.render();this._marker=new(b("AggregatedMapMarker"))(d,this._sprite);if(this.isSinglePin()){var e=c.getBaseZIndex&&c.getBaseZIndex()||b("AggregatedMapZIndex").DEFAULT_PIN_BASE_Z_INDEX;e+=b("clamp")(Math.floor(this.getCenter().y),0,b("AggregatedMapZIndex").PIN_Z_INDEX_MAXIMUM_ADD);c.setZIndex?c.setZIndex(Math.floor(e)):b("Style").set(d,"z-index",Math.floor(e))}b("DOM").appendContent(a,d)}return this._marker},add:function(a,b){return this._boundingBox.add(a,b)}});e.exports=a}),null);
__d("GeoRectangle",["GeoCoordinates","ImmutableObject"],(function(a,b,c,d,e,f){__p&&__p();var g=function(b){"use strict";__p&&__p();babelHelpers.inheritsLoose(a,b);function a(a,c,d,e){return b.call(this,{n:a,w:c,s:d,e:e})||this}var c=a.prototype;c.containsLat=function(a){return a>=this.s&&a<=this.n};c.getCenter=function(){var a=(this.n+this.s)/2,b;b=(this.e+this.w)/2;this.w>this.e&&(b-=180,b<-180&&(b+=360));return{latitude:a,longitude:b}};c.containsLon=function(a){return this.w>this.e?a>=this.w||a<=this.e:a>=this.w&&a<=this.e};c.getHeight=function(){return this.n-this.s};c.getWidth=function(){var a=this.e;this.w>this.e&&(a+=360);return a-this.w};c.containsPoint=function(a,b){return this.containsLat(a)&&this.containsLon(b)};c.containsGeoRectangle=function(a){return this.containsPoint(a.n,a.w)&&this.containsPoint(a.s,a.e)};c.toArray=function(){return{n:this.n,w:this.w,s:this.s,e:this.e}};return a}(b("ImmutableObject"));g.fromPoints=function(a){__p&&__p();if(!a||a.length===0)return null;if(a.length===1){var b=a[0];return new g(b.latitude,b.longitude,b.latitude,b.longitude)}b=a.map(function(a){return a.latitude});a=a.map(function(a){return a.longitude}).sort(function(a,b){return a-b});var c=360+a[0]-a[a.length-1],d=a.length-1,e=0;for(var f=0;f<a.length-1;f++){var h=a[f+1]-a[f];h>c&&(c=h,d=f,e=f+1)}return new g(Math.max.apply(Math,b),a[e],Math.min.apply(Math,b),a[d])};e.exports=g}),null);
__d("AggregatedMap",["csx","AggregatedMapCallout","AggregatedMapCalloutOrientation","AggregatedMapGroup","AggregatedMapZIndex","Arbiter","CSS","DOM","Event","GeoRectangle","LegacyMapCoordinate","LegacyMapUtils","MapAggregation","MapRects","Rect","Run","Style","Vector","$","clamp","leaflet"],(function(a,b,c,d,e,f,g){__p&&__p();var h=10,i=7,j=100,k=50,l=500,m=409,n=90,o=90,p=.15,q=10,r=10,s=10,t=new(b("Rect"))(50,50,50,50);function u(a,c,d,e,f,g,i){this.mapReady=!1,this.lastZoom=null,this.initialView=null,this.lastRender=null,this.visiblePins=[],this.groups=[],this.callouts=[],this.zoomStack=[],this.initialPinsToHide=[],this.arrowYOffset=o,this.padding=j+k,this.topLeft=b("LegacyMapCoordinate").fromLatLong(0,0),this.dynamicMap=a,this.canvas=c,this.instanceid=d,this.logger=g,this.maxZoom=e.maxZoom,this.minZoom=e.minZoom,this.maxCalloutWidth=e.maxCalloutWidth||e.width-h,this.maxCalloutHeight=e.maxCalloutHeight||e.height-h,this.pad={},this.setViewportPadding(e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft),this.listeners=[],this.bingMapEvents=[],b("Run").onLeave(this._onBeforeLeave.bind(this)),this.dynamicMap.onInit(this._onInit.bind(this,f,i))}Object.assign(u.prototype,{CALLOUT_MARGIN:10,noPanningStrategy:function(a){return this._noPan.bind(this,a)},leftRightNoPanningStrategy:function(){return this._leftRightNoPan.bind(this)},anchoredPanningStrategy:function(a,b){return this._anchoredPan.bind(this,a,b)},smartPanningStrategy:function(a,b){return this._smartPan.bind(this,a,b)},getMap:function(){this._assertInitialized();return this.map},setPins:function(a){this._assertInitialized(),this.visiblePins=a,this.calloutAnchor=null,this._setZoomButtonVisibility(),this._aggregate()},getGroups:function(){return this.groups},getWidth:function(){return this._getW()-this.pad.l-this.pad.r},getAbsoluteWidth:function(){return this._getW()},getHeight:function(){return this._getH()-this.pad.t-this.pad.b},getAbsoluteHeight:function(){return this._getH()},getBounds:function(){var a=this.dynamicMap.getBounds();return new(b("GeoRectangle"))(a.getNorth(),a.getWest(),a.getSouth(),a.getEast())},pushView:function(){this._assertInitialized(),this.zoomStack.push(this._getMapView())},invalidateSize:function(){this.dynamicMap.invalidateSize()},zoomIntoOne:function(a,b){this._assertInitialized(),this.pushView(),this.zoomToOne(a,b)},zoomToOne:function(a,b,c){this.zoomToOneTight(a,b,0,c)},zoomToOneTight:function(a,c,d,e){this._assertInitialized();c=c||new(b("Vector"))(0,0);d=d||0;e=e||!1;d=Math.max(this._findMinZoomWherePinIsAlone(a),d,this.getZoom());a.setZoom(d);a=a.anchor.add(d,c.mul(-1));this._setMapView({zoom:d,center:{latitude:a.getLatitude(),longitude:a.getLongitude()},animate:e},"persistent")},zoomInto:function(a){this._assertInitialized(),this.pushView(),this.zoomTo(a)},removePin:function(a){this._assertInitialized(),this.removePins([a])},removePins:function(a){__p&&__p();this._assertInitialized();for(var b=0;b<a.length;b++)a[b]._aggregated_map_remove=!0;b=[];for(var c=0;c<this.visiblePins.length;c++)this.visiblePins[c]._aggregated_map_remove||b.push(this.visiblePins[c]);for(var c=0;c<a.length;c++)delete a[c]._aggregated_map_remove;this.visiblePins=b;this._aggregate()},addPins:function(a){this._assertInitialized();this.visiblePins=this.visiblePins||[];for(var b=0;b<a.length;b++)this.visiblePins.push(a[b]);this._aggregate()},addPin:function(a){this._assertInitialized(),this.addPins([a])},zoomOut:function(){this._assertInitialized(),this.logger&&this.logger.bumpTap("zoom-out"),this.zoomDelta(-1,!0)},zoomIn:function(){this._assertInitialized(),this.logger&&this.logger.bumpTap("zoom-in"),this.zoomDelta(1,!0)},zoomBack:function(){this._assertInitialized();this.logger&&this.logger.bumpTap("snap-back");var a;this.zoomStack.length?a=this.zoomStack.pop():(a={},Object.assign(a,this.initialView),a.zoom=Math.min(a.zoom,this.getZoom()));this._setMapView(a)},setInitialView:function(){this._assertInitialized();this.initialView=this._getMapView();var a=b("DOM").scry(this.canvas,"span.__0")[0];a&&b("CSS").hide(a)},closeCalloutAndZoomBack:function(){this._assertInitialized(),this.hideCallout(),this.zoomBack()},onAddPin:function(a,b){a=b.pin;b=b.content;this.hideCallout();this.addPin(a);this.zoomIntoOne(a);this.openCallout(a,b)},zoomDelta:function(a,c){__p&&__p();a=b("clamp")(this.getZoom()+a,this.minZoom,this.maxZoom)-this.getZoom();if(!a)return;var d=null;if(c&&this._getPrimaryCalloutAnchorGroup()){d=this._getPrimaryCalloutAnchorGroup().getCenter();c=!b("MapRects").containsPoint(new(b("Rect"))(0,this._getW(),this._getH(),0),d);c&&(d=null)}d===null&&(d={x:this._getW()/2+this._getCenterOffset().x,y:this._getH()/2+this._getCenterOffset().y});c=this.map.tryPixelToLocation(b("leaflet").point(d.x,d.y));d=b("leaflet").point(d.x-this.map.getWidth()/2,d.y-this.map.getHeight()/2);this._zoom(!0,a,c,d)},getZoom:function(){return this.map.getZoom()},getCenter:function(){return this.map.getCenter()},getView:function(){return this._getMapView()},setView:function(a){this._assertInitialized(),this._setMapView(a)},setViewportPadding:function(a,b,c,d){this.pad.t=a,this.pad.r=b,this.pad.b=c,this.pad.l=d},redraw:function(){this._assertInitialized(),this._aggregate()},zoomTo:function(a,c){__p&&__p();this._assertInitialized();if(a.length<1)return;var d=this.maxZoom;if(a.length<q)while(this._aggregateZoom(a,d-1).length==a.length&&d>=r)d--;var e=[];for(var f=0;f<a.length;f++){var g={latitude:a[f].getLatitude(),longitude:a[f].getLongitude()};e.push(g)}g=b("LegacyMapUtils").getViewForLatLongs(this._getW(),this._getH(),e,t,this.minZoom,d);delete g.height;delete g.width;g.animate=c;this._setMapView(g,"persistent")},hideCallout:function(a){this._assertInitialized();var b=this._getPrimaryCalloutAnchor();this._getInternalCallout().close();b&&!a&&this._inform("calloutHidden")},throbber:function(a){a=a||m;return b("AggregatedMapCallout").throbber(a)},openCallout:function(a,b,c){this._getTooltipCallout().getAnchor()===a&&this._getTooltipCallout().close();this._getInternalCallout().setContent(b);this._getInternalCallout()._map_moveTo(a,c);return this._getInternalCallout()},getCallout:function(){return this._getInternalCallout()},setExternalCalloutAnchor:function(a){this._externalCalloutAnchor=a},openTooltip:function(a,b,c){if(this._getInternalCallout().getAnchor()===a)return;this._getTooltipCallout().setContent(b);this._getTooltipCallout()._map_moveTo(a,c);return this._getTooltipCallout()},getTooltip:function(){return this._getTooltipCallout()},updateCallouts:function(){for(var a=0;a<this.callouts.length;a++)this.callouts[a]._map_updatePosition()},_onInit:function(a,c){__p&&__p();this.map=this.dynamicMap;this.bingMapEvents=[{name:"movestart move",callback:this._onViewChange},{name:"moveend",callback:this._onViewChangeEnd},{name:"mouseup",callback:this._onMouseUp},{name:"mousedown",callback:this._onMouseDown},{name:"zoomstart",callback:this._onZoomStart}];this.bingMapEvents.forEach(function(a){this.map.on(a.name,a.callback,this)},this);this._onViewChange();this.initialized=!0;for(var d=0;d<a.length;d++)a[d].xhp&&this.initialPinsToHide.push(a[d].xhp);a.length&&this.setPins(a);c&&(a[0].setCallout(b("$")(c)),this._getInternalCallout()._map_moveTo(a[0],this.noPanningStrategy(b("AggregatedMapCalloutOrientation").TOP)));b("CSS").hide(b("DOM").scry(this.canvas,".fbAggregatedMapCalloutShell")[0]);for(var e in u.Listeners)this._subscribe("AggregatedMap/"+e,this[e].bind(this));this._inform(u.Events.ready,this,"state")},_callout_getAnchorBounds:function(a){a=this._getCalloutAnchorGroup(a);a=a&&a.getSpriteBounds();return a},_callout_panTo:function(a,c,d){a=this._callout_getAnchorBounds(a);d=d?d(c,a):null;if(d){c=b("LegacyMapUtils").xyToLatLong(this.dynamicMap.pixelToMap(d),this.getZoom());this._setMapView({center:c})}},_callout_determineArrowYOffset:function(a,c,d,e){__p&&__p();d=this._callout_getAnchorBounds(a.getAnchor());a=new(b("Vector"))((d.l+d.r)/2,d.calloutY);d=e/2;var f=this._getVisibleBounds(),g=b("MapRects").containsPoint(this._getNoPanBounds(e),a,1),h=d;if(c||g){c=f.t+d+this.CALLOUT_MARGIN;g=f.b-(e-d)-this.CALLOUT_MARGIN;h+=a.y-b("clamp")(a.y,c,g)}h=b("clamp")(h,b("AggregatedMapCallout").ARROW_WIDTH/2,e-b("AggregatedMapCallout").ARROW_WIDTH/2);return h},_createCallout:function(a){var c=b("DOM").scry(this.canvas,".fbAggregatedMapCalloutShell")[0];c=c.cloneNode(!0);b("DOM").appendContent(this.canvas,c);b("Style").set(c,"z-index",a);a=new(b("AggregatedMapCallout"))(this,c);this.callouts.push(a);return a},_getInternalCallout:function(){this.internalCallout=this.internalCallout||this._createCallout(b("AggregatedMapZIndex").CALLOUT_Z_INDEX);return this.internalCallout},_getTooltipCallout:function(){this.tooltipCallout=this.tooltipCallout||this._createCallout(b("AggregatedMapZIndex").TOOLTIP_Z_INDEX);return this.tooltipCallout},_assertInitialized:function(){},_guard:function(a){return function(b,c){if(!(!c||!c._instanceid))if(c._instanceid===this.instanceid)return a(b,c)}.bind(this)},_subscribe:function(a,c){this.listeners.push(b("Arbiter").subscribe(a,this._guard(c)))},_inform:function(a,c,d){c=c||{},c._instanceid=this.instanceid,b("Arbiter").inform("AggregatedMap/"+a,c,d)},_bubbleClick:function(a){this._inform(u.Events.bubbleClick,a)},_bubbleMouseover:function(a){this._inform(u.Events.bubbleMouseover,a)},_bubbleMouseout:function(a){this._inform(u.Events.bubbleMouseout,a)},_pinClick:function(a){a._agg_map_callout&&(this.getCallout().getAnchor()===a?this.hideCallout():this.openCallout(a,a._agg_map_callout)),this._inform(u.Events.pinClick,a)},_pinMouseover:function(a){if(a.name){var c=b("DOM").create("span");b("CSS").addClass(c,"fbAggregatedMapTooltipText");b("DOM").setContent(c,a.name);this.openTooltip(a,c,this.leftRightNoPanningStrategy())}this._inform(u.Events.pinMouseover,a)},_pinMouseout:function(a){this.tooltipCallout&&this.tooltipCallout.getAnchor()===a&&a.name&&this.tooltipCallout.close(),this._inform(u.Events.pinMouseout,a)},_getVisibleBounds:function(){return new(b("Rect"))(this.pad.t,this._getW()-this.pad.r,this._getH()-this.pad.b,this.pad.l)},_getCenterOffset:function(){return{x:(this.pad.l-this.pad.r)/2,y:(this.pad.t-this.pad.b)/2}},_setMapView:function(a,c){c=this._getCenterOffset();a.centerOffset&&(c.x+=a.centerOffset.x,c.y+=a.centerOffset.y);a.centerOffset=b("leaflet").point(c.x,c.y);a.center&&(a.center=b("leaflet").latLng(a.center.latitude,a.center.longitude));this.map.setView(a)},_findMinZoomWherePinIsAlone:function(a){__p&&__p();if(this.visiblePins.length<2)return this.minZoom;var b=Number.MAX_VALUE,c=null,d=a.anchor.getAbsoluteXY();for(var e=0;e<this.visiblePins.length;e++){var f=this.visiblePins[e],g=f.anchor.getAbsoluteXY().distanceTo(d);g<b&&f!==a&&(b=g,c=f)}g=a.getAggregationRadius()+c.getAggregationRadius();f=this.maxZoom;while(b/2>g&&f>this.minZoom)f--,b/=2;while(f<this.maxZoom){e=this._aggregateZoom(this.visiblePins,f);for(var d=0;d<e.length;d++){c=e[d];if(c.members.length==1&&c.members[0]===a)return f}f++}return f},_smartPan:function(a,c,d,e){__p&&__p();a=a||this.maxCalloutWidth;c=c||this.maxCalloutHeight;var f=b("MapRects").pad(this._getNoPanBounds(c),l-this.CALLOUT_MARGIN),g=new(b("Vector"))(e.getCenter().x,e.calloutY);if(b("MapRects").containsPoint(f,g)){f=this._getVisibleBounds();c=g.sub(b("MapRects").boundPoint(this._getNoPanBounds(c),g));a=e.w()/2+b("AggregatedMapCallout").ARROW_HEIGHT_PLUS_PADDING+a+this.CALLOUT_MARGIN;g.x>f.getCenter().x?(d.setOrientation(b("AggregatedMapCalloutOrientation").LEFT),c.x||(c.x=g.x-Math.max(g.x,a+f.l))):(d.setOrientation(b("AggregatedMapCalloutOrientation").RIGHT),c.x||(c.x=g.x-Math.min(g.x,f.r-a)));d=null;c.magnitude()>=1&&(d=new(b("Vector"))(this._getW()/2+c.x+this._getCenterOffset().x,this._getH()/2+c.y+this._getCenterOffset().y));return d}return this._anchoredPan(u.Anchor.DEFAULT,b("AggregatedMapCalloutOrientation").RIGHT,this._getInternalCallout(),e)},_leftRightNoPan:function(a,c){c.getCenter().x>this._getVisibleBounds().getCenter().x?a.setOrientation(b("AggregatedMapCalloutOrientation").LEFT):a.setOrientation(b("AggregatedMapCalloutOrientation").RIGHT)},_noPan:function(a,b,c){b.setOrientation(a)},_anchoredPan:function(a,c,d,e){var f=this._getVisibleBounds();d.setOrientation(c);a===u.Anchor.DEFAULT&&(a=new(b("Vector"))(f.getCenter().x-this.maxCalloutWidth/2-e.w()/2,f.getCenter().y-p*this._getH()-o+b("AggregatedMapCallout").ARROW_WIDTH/2));return e.getCenter().sub(a).add(new(b("Vector"))(this._getW()/2,this._getH()/2))},_renderOverlay:function(){__p&&__p();if(!this.mapReady)return;this.lastRender=this.topLeft;var a,c=new(b("Rect"))(-this.padding,this._getW()+this.padding,this._getH()+this.padding,-this.padding);for(var d=0;d<this.groups.length;d++){a=this.groups[d];var e=a.getCenter();if(b("MapRects").containsPoint(c,e)){e=a.renderMarker(this.canvas);a.pins.length>1?(e.setOnClick(this._bubbleClick.bind(this,a)),e.setOnMouseover(this._bubbleMouseover.bind(this,a)),e.setOnMouseout(this._bubbleMouseout.bind(this,a))):(e.setOnClick(this._pinClick.bind(this,a.pins[0])),e.setOnMouseover(this._pinMouseover.bind(this,a.pins[0])),e.setOnMouseout(this._pinMouseout.bind(this,a.pins[0])))}else a.dismissMarker()}this._position();while(this.initialPinsToHide.length)b("CSS").hide(this.initialPinsToHide.pop())},_getNoPanBounds:function(a){a=this._getVisibleBounds();return b("MapRects").pad(new(b("Rect"))(a.t+n,a.r,a.b-n,a.l),-this.CALLOUT_MARGIN)},_getCalloutAnchorGroup:function(a){return a&&(a.group||a)},_getPrimaryCalloutAnchor:function(){return this._getInternalCallout().getAnchor()||this._externalCalloutAnchor},_getPrimaryCalloutAnchorGroup:function(){return this._getCalloutAnchorGroup(this._getPrimaryCalloutAnchor())},_zoom:function(a,c,d,e){c=Math.max(b("LegacyMapCoordinate").MIN_ZOOM,Math.min(this.getZoom()+c,b("LegacyMapCoordinate").MAX_ZOOM)),this.map.setView({animate:a,zoom:c,center:d,centerOffset:e})},_getMapView:function(){return{center:this.map.getCenter(),zoom:this.map.getZoom(),width:this.map.getWidth(),height:this.map.getHeight()}},_setZoomButtonVisibility:function(){var a=b("DOM").scry(this.canvas,"label.__1")[0],c=b("DOM").scry(this.canvas,"label.__2")[0];a&&b("CSS").conditionClass(a,"uiButtonDisabled",this.getZoom()>=this.maxZoom);c&&b("CSS").conditionClass(c,"uiButtonDisabled",this.getZoom()<=this.minZoom)},_aggregate:function(){__p&&__p();this.logger&&this.logger.startRun("_aggregate");var a,c=this._aggregateZoom(this.visiblePins,this.getZoom()),d=[];for(var e=0;e<c.length;e++){var f=c[e];a=new(b("AggregatedMapGroup"))(f.members,f.rect,f.sprite,this.dynamicMap.mapToPixel.bind(this.dynamicMap));d.push(a);for(var g=0;g<f.members.length;g++)f.members[g].group=a}for(var f=0;f<this.groups.length;f++)a=this.groups[f],a.dismissMarker(),a.deleted=!0;for(var g=0;g<this.callouts.length;g++)this.callouts[g].getAnchor()&&this.callouts[g].getAnchor().getType()==="AggregatedMapGroup"&&this.callouts[g].close();this.groups=d;this._renderOverlay();this.logger&&this.logger.endRun("_aggregate")},_combine:function(a,c){for(var d=0;d<c.members.length;d++)a.members.push(c.members[d]);a.rect=b("MapRects").boundingBox(a.rect,c.rect);a.sprite=a.sprite.combine(c.sprite);a.radius=a.sprite.getAggregationRadius();a.center=a.rect.getCenter();a.single=0;return a},_overlap:function(a,b){var c=a.center.y-b.center.y,d=a.center.x-b.center.x;a.single+b.single==1&&(a.single&&c>i/2?c-=i:b.single&&-c<i/2&&(c+=i));a=a.radius+b.radius;return d*d+c*c<a*a},_aggregateZoom:function(a,c){__p&&__p();for(var d=0;d<a.length;d++){a[d].setZoom(c);var e=a[d].center;a[d].rect=new(b("Rect"))(e.y,e.x,e.y,e.x);a[d].single=1}e=[];d=[];for(var f=0;f<a.length;f++){var g=a[f],h={};Object.assign(h,g);h.radius=g.getAggregationRadius();h.members=[g];h.radius?e.push(h):d.push(h)}c<this.maxZoom&&e.length>1&&(e=new(b("MapAggregation"))().aggregate(e,this._combine.bind(this),this._overlap.bind(this)));return e.concat(d)},_position:function(){this.logger&&this.logger.startRun("_position");var a=this._getW()/2;for(var b=0;b<this.groups.length;b++)this.groups[b].updatePosition(a);this.updateCallouts();this.logger&&this.logger.endRun("_position")},_getDims:function(){return new(b("Vector"))(this._getW(),this._getH())},_getH:function(){return this.map.getHeight()},_getW:function(){return this.map.getWidth()},_onMapClick:function(){this._inform(u.Events.mapClick)},_onViewChangeEnd:function(){this._inform(u.Events.viewChangeEnd,this._getMapView(),"state")},_onViewChange:function(){__p&&__p();this.mapReady=!0;this._inform(u.Events.viewChange,this._getMapView(),"state");this.topLeft=b("LegacyMapCoordinate").fromLatLong(this.getCenter()).add(this.getZoom(),this._getDims().mul(-.5));if(this.lastZoom!==this.getZoom()){this.lastZoom=this.getZoom();while(this.zoomStack.length&&this.getZoom()<=this.zoomStack[this.zoomStack.length-1].zoom)this.zoomStack.pop();this._setZoomButtonVisibility();this._aggregate()}else!this.lastRender||this.topLeft.calculateDistanceX(this.getZoom(),this.lastRender)>j||this.topLeft.calculateDistanceY(this.getZoom(),this.lastRender)>j?this._renderOverlay():this._position();var a=b("DOM").scry(this.canvas,"span.__0")[0];a&&b("CSS").conditionShow(a,this._showSnapBack())},_showSnapBack:function(){__p&&__p();if(this.zoomStack.length)return!0;else if(this.initialView){var a=this.initialView;if(this.getZoom()>a.zoom)return!0;else{var c=this._getMapView(),d=s/b("LegacyMapUtils").scale(1,this.getZoom());return Math.abs(c.center.latitude-a.center.latitude)>d||Math.abs(c.center.longitude-a.center.longitude)>d}}return!1},_onMouseDown:function(a){this.xDown=a.pageX,this.yDown=a.pageY},_onMouseUp:function(a){this.xDown==a.pageX&&this.yDown==a.pageY&&this._onMapClick()},_onZoomStart:function(a){for(var a=0;a<this.groups.length;a++)this.groups[a].dismissMarker()},_onBeforeLeave:function(){for(var a=0;a<this.listeners.length;a++)this.listeners[a].unsubscribe();this.bingMapEvents.forEach(function(a){this.map.off(a.name,a.callback,this)},this)}});Object.assign(u,{Anchor:{DEFAULT:"default_anchor"},Events:{calloutHidden:"calloutHidden",ready:"ready",mapClick:"mapClick",viewChange:"viewChange",viewChangeEnd:"viewChangeEnd",bubbleClick:"bubbleClick",bubbleMouseover:"bubbleMouseover",bubbleMouseout:"bubbleMouseout",pinClick:"pinClick",pinMouseover:"pinMouseover",pinMouseout:"pinMouseout",onSearchSubmit:"onSearchSubmit"},Listeners:{hideCallout:"hideCallout",zoomDelta:"zoomDelta",zoomIn:"zoomIn",zoomOut:"zoomOut",zoomBack:"zoomBack",closeCalloutAndZoomBack:"closeCalloutAndZoomBack",onAddPin:"onAddPin"},inform:function(a,c,d,e){d||(d={},d._instanceid=a),b("Arbiter").inform("AggregatedMap/"+c,d,e)},listenThenInform:function(a,c,d,e){b("Event").listen(c,d,function(){u.inform(a,e)})},subscribe:function(a,c,d){b("Arbiter").subscribe("AggregatedMap/"+c,u._guard(a,d))},subscribeAll:function(a,b){for(var c in u.Events){var d=b["aggregatedMapHandler_"+c];d&&(d=d.bind(b),u.subscribe(a,c,d))}},_guard:function(a,b){return function(b,c,d){if(!d._instanceid)throw new Error("aggregated map didnt pass instanceid");else if(d._instanceid!==a)return;return b(d)}.bind(this,b)}});e.exports=u}),null);
__d("AggregatedMapCircleSprite",["DOM"],(function(a,b,c,d,e,f){__p&&__p();function g(a,b,c,d){this._size=a,this._radius=b,d&&(this.chooseAggregationRadius=d,this._aggregationRadius=d(this._size)),this._count=c}function a(){return this._radius}function c(){return this._radius*2}function h(a){switch(a){case g.SIZE_SMALL:return 9;case g.SIZE_MEDIUM:return 11;case g.SIZE_LARGE:return 16}}function d(a){var b;this.chooseAggregationRadius?b=this.chooseAggregationRadius:b=h;a=this.getCount()+a.getCount();if(a>=100)return g.large(a,b);else if(a>=10)return g.medium(a,b);else return g.small(a,b)}Object.assign(g.prototype,{render:function(){var a,c=(a=b("DOM")).create("div",{className:["fbAggregatedMapBubble","fbAggregatedMapBubble"+this._size].join(" ")});a.setContent(c,this._count);var d=a.create("div",{className:["fbAggregatedMapBubbleShell","fbAggregatedMapBubbleShell"+this._size].join(" ")});a.setContent(d,c);this._root=d;return d},combine:d,getCount:function(){return this._count},getHeight:c,getWidth:c,getAnchorX:a,getAnchorY:a,getCalloutX:a,getCalloutY:a,getAggregationRadius:function(){return this._aggregationRadius}});Object.assign(g,{RADIUS_SMALL:15,RADIUS_MEDIUM:20,RADIUS_LARGE:28,SIZE_SMALL:"Small",SIZE_MEDIUM:"Medium",SIZE_LARGE:"Large",small:function(a,b){return new g(g.SIZE_SMALL,g.RADIUS_SMALL,a,b)},medium:function(a,b){return new g(g.SIZE_MEDIUM,g.RADIUS_MEDIUM,a,b)},large:function(a,b){return new g(g.SIZE_LARGE,g.RADIUS_LARGE,a,b)},combine:d});e.exports=g}),null);
__d("AggregatedMapPin",["LegacyMapCoordinate"],(function(a,b,c,d,e,f){__p&&__p();function g(a,c,d,e,f){this.anchor=b("LegacyMapCoordinate").fromLatLong(a),this.sprite=c,this.name=d||null,this.group=null,this.xhp=e,this.profileID=f}Object.assign(g.prototype,{getType:function(){return"AggregatedMapPin"},setZoom:function(a){this.center=this.anchor.getMapXY(a)},getLatitude:function(){return this.anchor.getLatitude()},getLongitude:function(){return this.anchor.getLongitude()},getGroup:function(){return this.group},getAggregationRadius:function(){return this.sprite.getAggregationRadius()},setSprite:function(a){this.sprite=a},setCallout:function(a){this._agg_map_callout=a}});Object.assign(g,{create:function(a,b,c,d){return new g(a,b,c,d)}});e.exports=g}),null);
__d("AggregatedMapRedPinSprite",["AggregatedMapCircleSprite","CSS","DOM"],(function(a,b,c,d,e,f){__p&&__p();function g(a,b,c,d,e,f,g,h,i){this.size=a,this.image=b,this.width=c,this.height=d,this.calloutY=e,this.aggregationRadius=f,this.text=h,this.count=g,this.css=i}Object.assign(g.prototype,{render:function(){__p&&__p();var a=b("DOM").create("div");b("CSS").addClass(a,"fbAggregatedMapPin");b("CSS").addClass(a,"fbAggregatedMapPin"+this.size);this.css&&b("CSS").addClass(a,this.css);var c="/images/places/map/"+this.image;c=b("DOM").create("img",{src:c});b("DOM").appendContent(a,c);c=null;this.text&&(c=b("DOM").create("div"),b("CSS").addClass(c,"fbAggregatedMapPinText"),b("CSS").addClass(c,"fbAggregatedMapPinText"+this.size),b("DOM").setContent(c,this.count),b("DOM").appendContent(a,c));return a},combine:b("AggregatedMapCircleSprite").combine,getCount:function(){return this.count},getHeight:function(){return this.height},getWidth:function(){return this.width},getAnchorX:function(){return this.width/2},getAnchorY:function(){return this.height},getCalloutX:function(){return this.width/2},getCalloutY:function(){return this.calloutY},getAggregationRadius:function(){return this.aggregationRadius}});Object.assign(g,{dot:function(a){a===void 0&&(a=1);return new g("Small","small_dot.png",17,22,8,10,a,!1)},smallBlank:function(a){return new g("Small","small_blank.png",17,22,8,10,a,!0)},mediumBlank:function(a){return new g("Medium","medium_blank.png",25,34,12,14,a,!0)},largeBlank:function(a){return new g("Large","large_blank.png",29,43,14,17,a,!0)}});e.exports=g}),null);
__d("DoublyLinkedListMap",[],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(){this._head=null,this._tail=null,this._nodes={},this._nodeCount=0}var b=a.prototype;b.get=function(a){a=(a=this._nodes[a])!=null?a.data:a;return a?a:null};b.getIndex=function(a){var b=this._head;for(var c=0;b;b=b.next,c++)if(b.key===a)return c;return null};b._insert=function(a,b,c,d){c&&!this._nodes[c]&&(c=null);c&&this._nodes[c]?c=this._nodes[c]:c=d?this._head:this._tail;b={data:b,key:a,next:null,prev:null};c&&(this.remove(a),d?(b.prev=c.prev,c.prev&&(c.prev.next=b),c.prev=b,b.next=c):(b.next=c.next,c.next&&(c.next.prev=b),c.next=b,b.prev=c));b.prev===null&&(this._head=b);b.next===null&&(this._tail=b);this._nodes[a]=b;this._nodeCount++;return this};b.insertBefore=function(a,b,c){return this._insert(a,b,c,!0)};b.insertAfter=function(a,b,c){return this._insert(a,b,c,!1)};b.prepend=function(a,b){return this.insertBefore(a,b,this._head&&this._head.key)};b.append=function(a,b){return this.insertAfter(a,b,this._tail&&this._tail.key)};b.remove=function(a){__p&&__p();var b=this._nodes[a];if(b){var c=b.next,d=b.prev;c&&(c.prev=d);d&&(d.next=c);this._head===b&&(this._head=c);this._tail===b&&(this._tail=d);delete this._nodes[a];this._nodeCount--}return this};b.find=function(a){for(var b=this._head;b;b=b.next)if(a(b.data))return b.key;return null};b.reduce=function(a,b){for(var c=this._head;c;c=c.next)b=a(c.data,b);return b};b.exists=function(a){return!!this._nodes[a]};b.isEmpty=function(){return!this._head};b.reset=function(){this._head=null,this._tail=null,this._nodes={},this._nodeCount=0};b.map=function(a){for(var b=this._head;b;b=b.next)a(b.data)};b.getCount=function(){return this._nodeCount};b.getHead=function(){var a;return(a=this._head)!=null?a.data:a};b.getTail=function(){var a;return(a=this._tail)!=null?a.data:a};b.getNext=function(a){return(a=this._nodes[a])!=null?(a=a.next)!=null?a.data:a:a};b.getPrev=function(a){return(a=this._nodes[a])!=null?(a=a.prev)!=null?a.data:a:a};b.getHeadKey=function(){var a;return(a=this._head)!=null?a.key:a};b.getTailKey=function(){var a;return(a=this._tail)!=null?a.key:a};return a}();e.exports=a}),null);
__d("ProfileOverviewSection",["CallbackDependencyManager","DOMScroll","DoublyLinkedListMap","TidyArbiterMixin","ge"],(function(a,b,c,d,e,f){__p&&__p();var g=null,h=new(b("CallbackDependencyManager"))(),i={};a=function(){"use strict";__p&&__p();function a(a,c,d){this.id=a,this.label=d,this.nodeID=c,this._isLoaded=!1,this._parentSection=null,this.childSections=new(b("DoublyLinkedListMap"))(),i[a]=this,window.setTimeout(function(){return h.satisfyPersistentDependency(a)},0)}var c=a.prototype;c.reset=function(){this.childSections.map(function(a){return a.reset()})};c.appendSection=function(a){this.childSections.append(a.id,a),a._parentSection=this};c.freeze=function(){this.freezeChildren()};c.freezeChildren=function(){var a=this.childSections.getHead();while(a)a.isActive()||a.freeze(),a=a.getNext()};c.getParent=function(){return this._parentSection};c.getChildren=function(){return this.childSections};c.getNext=function(){return this._parentSection&&this._parentSection.childSections.getNext(this.id)};c.getPrev=function(){return this._parentSection&&this._parentSection.childSections.getPrev(this.id)};c.isActive=function(){var a=this;while(a){if(a.id===g)return!0;a=a._parentSection}return!1};c.isLoaded=function(){return this._isLoaded};c.setIsLoaded=function(a){this._isLoaded=a;return this};c.scrollTo=function(){if(!b("ge")(this.nodeID))return;b("DOMScroll").scrollTo(this.getNode(),!0,!1,0,0,b("DOMScroll").scrollTo.bind(this).bind(null,this.getNode(),0))};c.thaw=function(){this.thawChildren()};c.thawChildren=function(){var a=this.childSections.getHead();while(a)a.thaw(),a=a.getNext()};c.getNode=function(){throw new Error("This function needs to be implemented in children.")};a.callWithSection=function(a,b){h.registerCallback(function(){b(i[a])},[a])};a.setActiveSectionID=function(a){g=a};a.resetGlobalState=function(){g=null,h=new(b("CallbackDependencyManager"))(),i={}};return a}();Object.assign(a,b("TidyArbiterMixin"));e.exports=a}),null);
__d("TimelineSmartInsert",["Run","UserAgent_DEPRECATED","Vector"],(function(a,b,c,d,e,f){__p&&__p();var g=100;function h(a){return a==="viewport"?b("Vector").getViewportDimensions().y:a}var i=!1,j=!1;function k(){if(j)return;b("Run").onLeave(l);j=!0}function l(){i=!1,j=!1}a={run:function(a,c,d){__p&&__p();k();if(!i||b("UserAgent_DEPRECATED").ie()<=8){c();return}var e=a.offsetHeight;c();c=a.offsetHeight;var f=b("Vector").getScrollPosition().y;a=b("Vector").getElementPosition(a).y;c!==e&&a<f&&a+e<f+h(d||g)&&window.scrollBy(0,c-e)},enable:function(){i=!0}};e.exports=a}),null);